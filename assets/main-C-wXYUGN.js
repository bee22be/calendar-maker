(function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const e of r.addedNodes)e.tagName==="LINK"&&e.rel==="modulepreload"&&n(e)}).observe(document,{childList:!0,subtree:!0})}function n(o){if(o.ep)return;o.ep=!0;const r=function(e){const c={};return e.integrity&&(c.integrity=e.integrity),e.referrerPolicy&&(c.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?c.credentials="include":e.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}(o);fetch(o.href,r)}})();const S=40,j={ja:["日","月","火","水","木","金","土"],en:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},m=new Konva.Stage({container:"container",width:1170,height:2532}),h=new Konva.Layer;m.add(h);const F=new Konva.Transformer({rotateEnabled:!1,anchorSize:40,padding:10,borderStroke:"gray",borderStrokeWidth:2,anchorFill:"white",anchorStroke:"black",anchorStrokeWidth:2,anchorCornerRadius:6,boundBoxFunc:function(t,n){return n.width<20||n.height<20?t:n}});h.add(F);const L=new Konva.Group({draggable:!0}),l=new Konva.Group({draggable:!0});h.add(L),h.add(l);const J=document.getElementById("startMonth"),H=new Date;for(let t=0;t<=6;t++){const n=new Date(H.getFullYear(),H.getMonth()+t,1),o=n.getFullYear(),r=n.getMonth()+1,e=document.createElement("option");e.value=`${o}-${r.toString().padStart(2,"0")}`,e.textContent=`${o}年${r}月`,J.appendChild(e)}const le=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],ce=["January","February","March","April","May","June","July","August","September","October","November","December"];function B(){const t=new Date(J.value);let n=t.getFullYear(),o=t.getMonth()+1;L.destroyChildren(),l.destroyChildren();const r=parseInt(document.getElementById("startDay").value),e=document.getElementById("borderColor").value,c=document.getElementById("bgColor").value,i=document.getElementById("borderEnabled").checked,y=document.getElementById("bgEnabled").checked,g=document.getElementById("lang").value,C=document.getElementById("borderRounded").checked,f=document.getElementById("fontFamily").value,D=document.getElementById("weekDisplay").checked,O=document.getElementById("weekFontBold").checked?"bold":"normal",Y=document.getElementById("weekFontSize").value,P=document.getElementById("weekFontColor").value,U=parseInt(document.getElementById("monthFontSize").value),G=document.getElementById("monthFontColor").value,Q=document.getElementById("monthFontBold").checked?"bold":"normal",V=parseInt(document.getElementById("fontSize").value),X=document.getElementById("fontColor").value,R=document.getElementById("fontColorSat").value,x=document.getElementById("fontColorSun").value,Z=document.getElementById("fontBold").checked?"bold":"normal",s=150,ee=600,te=g==="jp"?le[o-1]:ce[o-1],oe=new Konva.Text({x:0,y:390,width:m.width(),text:`${te}`,fontSize:U,fontFamily:f,fontStyle:Q,fill:G,align:"center"});L.add(oe);const ne=g==="jp"?j.ja:j.en,q=90;if(D)for(let d=0;d<7;d++){const u=(d+r)%7,a=ne[u];let E=[0,0,0,0];if(C&&(E=[d==0?S:0,d==6?S:0,0,0]),y){const v=new Konva.Rect({x:60+d*s,y:510,width:s,height:q,fill:c,stroke:i?e:"",strokeWidth:i?2:0,cornerRadius:E});l.add(v)}else if(i){const v=new Konva.Rect({x:60+d*s,y:510,width:s,height:q,stroke:i?e:"",strokeWidth:i?2:0});l.add(v)}const p=new Konva.Text({x:60+d*s,y:510,width:s,height:q,text:a,fontSize:Y,fontFamily:f,fontStyle:O,fill:u===0?x:u===6?R:P,align:"center",verticalAlign:"middle"});l.add(p)}l.on("mousedown",d=>{var u;u=l,F.nodes([u]),l.on("dragmove",()=>{m.container().style.cursor="move"}),l.on("dragend",()=>{m.container().style.cursor="default"})});const T=(new Date(n,o-1,1).getDay()-r+7)%7,K=new Date(n,o,0).getDate();let w=1;for(let d=0;d<6;d++){let u=!0;for(let a=0;a<7;a++)if(7*d+a>=T&&w<=K){u=!1;break}if(!u)for(let a=0;a<7;a++){const E=60+a*s,p=ee+150*d,v=d===0,$=w+(7-a)>K,z=a===0,_=a===6;let A=[0,0,0,0];C&&(A=[v&&z&&!D?S:0,v&&_&&!D?S:0,$&&_?S:0,$&&z?S:0]);const W=()=>{if(y||i){const ae=new Konva.Rect({x:E,y:p,width:s,height:150,fill:y?c:void 0,stroke:i?e:"",strokeWidth:i?2:0,cornerRadius:A});l.add(ae)}};if(7*d+a<T||w>K){W();continue}const re=new Date(n,o-1,w);let b=X;const N=(a+r)%7;N===0?b=x:N===6&&(b=R),JapaneseHolidays.isHoliday(re)&&(b=x),W();const de=new Konva.Text({x:E,y:p,width:s,height:150,text:w.toString(),fontSize:V,fontFamily:f,fontStyle:Z,fill:b,align:"center",verticalAlign:"middle"});l.add(de),w++}}h.draw()}B(),setTimeout(()=>{B()},1e3),["startMonth","startDay","lang","borderRounded","borderColor","bgColor","borderEnabled","bgEnabled","fontFamily","weekDisplay","weekFontBold","weekFontSize","weekFontColor","monthFontSize","monthFontColor","monthFontBold","fontSize","fontColor","fontColorSat","fontColorSun","fontBold"].forEach(t=>{document.getElementById(t).addEventListener("change",()=>{B(),setTimeout(()=>{B()},1e3)})}),document.getElementById("fileUpload").addEventListener("change",t=>{Array.from(t.target.files).forEach(n=>{const o=new FileReader;o.onload=function(r){const e=new Image;e.onload=function(){const c=e.width/e.height,i=m.height(),y=i*c,g=new Konva.Image({image:e,x:(m.width()-y)/2,y:0,width:y,height:i,draggable:!0});g.cache(),g.drawHitFromCache(),h.add(g),l.moveToTop(),L.moveToTop(),h.draw(),g.on("mousedown",C=>{var f;f=g,F.nodes([f]),l.on("dragmove",()=>{m.container().style.cursor="move"}),l.on("dragend",()=>{m.container().style.cursor="default"})})},e.src=r.target.result},o.readAsDataURL(n)})}),document.getElementById("downloadBtn").addEventListener("click",()=>{const t=new Date,n=`${t.getFullYear().toString().slice(-2)}${String(t.getMonth()+1).padStart(2,"0")}${String(t.getDate()).padStart(2,"0")}_${String(t.getHours()).padStart(2,"0")}${String(t.getMinutes()).padStart(2,"0")}${String(t.getSeconds()).padStart(2,"0")}`,o=m.toDataURL({pixelRatio:2}),r=document.createElement("a");r.download=`calendar-${n}.png`,r.href=o,r.click()}),document.querySelector("#header button").addEventListener("click",()=>{document.querySelector(".anothertools").classList.add("on")}),document.querySelector(".anothertools .dialog__close").addEventListener("click",()=>{document.querySelector(".anothertools").classList.remove("on")});const I=document.querySelector(".smart__setting"),k=document.querySelector(".smart__preview");window.onresize=function(){window.innerWidth>680&&k.classList.contains("on")&&(I.classList.add("on"),k.classList.remove("on"),document.querySelector(".controls").classList.remove("off"))},I.addEventListener("click",()=>{I.classList.add("on"),k.classList.remove("on"),document.querySelector(".controls").classList.remove("off")}),k.addEventListener("click",()=>{k.classList.add("on"),I.classList.remove("on"),document.querySelector(".controls").classList.add("off")});const M=document.querySelector("dialog.download"),ie=document.querySelector(".start__dl"),se=document.querySelector("dialog.download .dialog__close");ie.addEventListener("click",()=>{F.nodes([]),h.draw(),M.showModal(),M.classList.add("loading")}),se.addEventListener("click",()=>{M.close()});
